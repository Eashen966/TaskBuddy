<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment Manager</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="assignmentStyle.css">
</head>
<body>
<!-- NAVIGATION -->
<nav>
  <div class="nav-container">
    <!-- BRAND NAME -->
    <a href="HomePage.html" class="nav-brand">TaskBuddy</a>

    <!-- NAVIGATION LINKS -->
    <div class="nav-links">
      <a href="HomePage.html" class="nav-link">Home</a>
      <a href="assignmentmanager.html" class="nav-link">Assignments</a>
      <a href="studyPage.html" class="nav-link">Study Session</a>
      <a href="RevisionLog.html" class="nav-link">Revision Log</a>
      <a href="aboutus.html" class="nav-link">About Us</a>
    </div>

    <!-- BELL ICON with Bootstrap Dropdown -->
    <div class="notification dropdown">
      <i class="fa-solid fa-bell" id="notificationBell" data-bs-toggle="dropdown" aria-expanded="false"></i>
      <span class="badge" id="notification-count">0</span>
      
      <ul class="dropdown-menu dropdown-menu-end" id="notification-dropdown">
        <li class="dropdown-item-text text-center fw-bold" style="color: #ff69b4;">
          <i class="fas fa-bell"></i> Notifications
        </li>
        <li><hr class="dropdown-divider"></li>
        <li id="notification-list">
          <div class="dropdown-item text-center text-muted">No upcoming deadlines</div>
        </li>
      </ul>
    </div>
  </div>
</nav>

    <!-- Main Content -->
    <div class="main-content">
        <div class="content">
            <!-- Statistics -->
            <div class="stats-section">
                <div class="stat-card">
                    <h3 id="total-count">0</h3>
                    <p><i class="fas fa-tasks"></i> Total Assignments</p>
                </div>
                <div class="stat-card">
                    <h3 id="pending-count">0</h3>
                    <p><i class="fas fa-clock"></i> Pending</p>
                </div>
                <div class="stat-card">
                    <h3 id="done-count">0</h3>
                    <p><i class="fas fa-check-circle"></i> Completed</p>
                </div>
                <div class="stat-card">
                    <h3 id="overdue-count">0</h3>
                    <p><i class="fas fa-exclamation-triangle"></i> Overdue</p>
                </div>
            </div>

            <!-- Add New Assignment Section -->
            <div class="add-section">
                <div class="section-header">
                    <i class="fas fa-plus-circle"></i> ADD NEW ASSIGNMENT
                </div>
                <div class="form-content">
                    <form id="assignmentForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label><i class="fas fa-file-alt"></i> Assignment Name:</label>
                                    <input type="text" id="assignmentName" required placeholder="Enter assignment name">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label><i class="fas fa-book"></i> Subject:</label>
                                    <input type="text" id="subject" required placeholder="Enter subject">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label><i class="fas fa-calendar-alt"></i> Due Date:</label>
                                    <input type="date" id="dueDate" required>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="add-btn">
                            <i class="fas fa-plus"></i> Add to the list
                        </button>
                    </form>
                </div>
            </div>

            <!-- Assignments List Section -->
            <div class="list-section">
                <div class="section-header">
                    <i class="fas fa-list"></i> ASSIGNMENTS LIST
                </div>
                <div class="list-content">
                    <div id="assignmentsList">
                        <div class="empty-state">
                            <i class="fas fa-inbox" style="font-size: 3rem; color: #ddd; margin-bottom: 15px;"></i>
                            <p>No assignments yet. Add your first assignment above!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
    <p>
        Give us your feedback
        <a href="mailto:eashenraj256@gmail.com">here!</a>
    </p>
    <p>&copy; 2026 Study Dashboard. All rights reserved.</p>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>

    <!-- JavaScript -->
     
    <script>
        
        // Load assignments from localStorage
        function loadAssignments() {
            const assignments = JSON.parse(localStorage.getItem('assignments')) || [];
            const assignmentsList = document.getElementById('assignmentsList');
            
            // Check for overdue assignments and update status
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            assignments.forEach(assignment => {
                const dueDate = new Date(assignment.dueDate);
                dueDate.setHours(0, 0, 0, 0);
                
                if (dueDate < today && assignment.status === 'pending') {
                    assignment.status = 'overdue';
                }
            });
            
            // Save updated assignments
            localStorage.setItem('assignments', JSON.stringify(assignments));
            
            // Update statistics
            updateStats(assignments);
            
            if (assignments.length === 0) {
                assignmentsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox" style="font-size: 3rem; color: #ddd; margin-bottom: 15px;"></i>
                        <p>No assignments yet. Add your first assignment above!</p>
                    </div>
                `;
                return;
            }
            
            // Sort assignments: overdue first, then by due date
            assignments.sort((a, b) => {
                if (a.status === 'overdue' && b.status !== 'overdue') return -1;
                if (a.status !== 'overdue' && b.status === 'overdue') return 1;
                if (a.status === 'done' && b.status !== 'done') return 1;
                if (a.status !== 'done' && b.status === 'done') return -1;
                return new Date(a.dueDate) - new Date(b.dueDate);
            });
            
            assignmentsList.innerHTML = assignments.map((assignment, index) => {
                const dueDate = new Date(assignment.dueDate);
                const formattedDate = dueDate.toLocaleDateString('en-GB');
                const daysUntilDue = Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));
                
                let urgencyText = '';
                if (assignment.status === 'overdue') {
                    urgencyText = '<span class="text-danger"><i class="fas fa-exclamation-circle"></i> Overdue</span>';
                } else if (daysUntilDue === 0) {
                    urgencyText = '<span class="text-warning"><i class="fas fa-clock"></i> Due Today</span>';
                } else if (daysUntilDue === 1) {
                    urgencyText = '<span class="text-warning"><i class="fas fa-clock"></i> Due Tomorrow</span>';
                } else if (daysUntilDue > 0) {
                    urgencyText = `<span class="text-info"><i class="fas fa-calendar"></i> ${daysUntilDue} days left</span>`;
                }
                
                return `
                    <div class="assignment-item">
                        <div class="assignment-info">
                            <strong>${assignment.name}</strong>
                            <div class="assignment-meta">
                                <i class="fas fa-book"></i> ${assignment.subject} | 
                                <i class="fas fa-calendar-alt"></i> ${formattedDate} | 
                                ${urgencyText}
                            </div>
                        </div>
                        <div class="status-container">
                            <select class="status-select ${assignment.status}" 
                                    onchange="updateStatus(${assignment.id}, this.value)"
                                    data-id="${assignment.id}">
                                <option value="pending" ${assignment.status === 'pending' ? 'selected' : ''}>PENDING</option>
                                <option value="done" ${assignment.status === 'done' ? 'selected' : ''}>DONE</option>
                                <option value="overdue" ${assignment.status === 'overdue' ? 'selected' : ''}>OVERDUE</option>
                            </select>
                            <button class="delete-btn" onclick="deleteAssignment(${assignment.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update statistics
        function updateStats(assignments) {
            const total = assignments.length;
            const pending = assignments.filter(a => a.status === 'pending').length;
            const done = assignments.filter(a => a.status === 'done').length;
            const overdue = assignments.filter(a => a.status === 'overdue').length;
            
            document.getElementById('total-count').textContent = total;
            document.getElementById('pending-count').textContent = pending;
            document.getElementById('done-count').textContent = done;
            document.getElementById('overdue-count').textContent = overdue;
        }

        // Add new assignment
        document.getElementById('assignmentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('assignmentName').value.trim();
            const subject = document.getElementById('subject').value.trim();
            const dueDate = document.getElementById('dueDate').value;
            
            if (!name || !subject || !dueDate) {
                alert('Please fill in all fields!');
                return;
            }
            
            const assignments = JSON.parse(localStorage.getItem('assignments')) || [];
            
            const newAssignment = {
                id: Date.now(),
                name: name,
                subject: subject,
                dueDate: dueDate,
                status: 'pending',
                createdAt: new Date().toISOString()
            };
            
            assignments.push(newAssignment);
            localStorage.setItem('assignments', JSON.stringify(assignments));
            
            // Reset form
            this.reset();
            
            // Reload assignments
            loadAssignments();
            loadNotifications();
            
            // Show success message
            showToast('Assignment added successfully!');
        });

        // Update assignment status
        function updateStatus(id, newStatus) {
            const assignments = JSON.parse(localStorage.getItem('assignments')) || [];
            const assignment = assignments.find(a => a.id === id);
            
            if (assignment) {
                assignment.status = newStatus;
                localStorage.setItem('assignments', JSON.stringify(assignments));
                loadAssignments();
                loadNotifications();
                showToast('Status updated!');
            }
        }

        // Delete assignment
        function deleteAssignment(id) {
            if (confirm('Are you sure you want to delete this assignment?')) {
                let assignments = JSON.parse(localStorage.getItem('assignments')) || [];
                assignments = assignments.filter(a => a.id !== id);
                localStorage.setItem('assignments', JSON.stringify(assignments));
                loadAssignments();
                loadNotifications();
                showToast('Assignment deleted!');
            }
        }

        // Load notifications
        function loadNotifications() {
            const assignments = JSON.parse(localStorage.getItem('assignments')) || [];
            const notificationList = document.getElementById('notification-list');
            const notificationCount = document.getElementById('notification-count');
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const upcoming = assignments.filter(a => {
                if (a.status !== 'pending' && a.status !== 'overdue') return false;
                const dueDate = new Date(a.dueDate);
                dueDate.setHours(0, 0, 0, 0);
                const daysUntilDue = Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));
                return daysUntilDue <= 7 && daysUntilDue >= 0;
            }).sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));
            
            if (upcoming.length > 0) {
                notificationCount.textContent = upcoming.length;
                notificationCount.style.display = 'block';
                
                notificationList.innerHTML = upcoming.map(assignment => {
                    const dueDate = new Date(assignment.dueDate);
                    const formattedDate = dueDate.toLocaleDateString('en-GB');
                    const daysUntilDue = Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));
                    
                    let urgencyText = '';
                    if (daysUntilDue === 0) urgencyText = 'Due Today!';
                    else if (daysUntilDue === 1) urgencyText = 'Due Tomorrow';
                    else urgencyText = `Due in ${daysUntilDue} days`;
                    
                    return `
                        <div class="dropdown-item">
                            <strong>${assignment.name}</strong><br>
                            <small>${assignment.subject}</small><br>
                            <small class="text-danger"><i class="fas fa-calendar"></i> ${urgencyText} - ${formattedDate}</small>
                        </div>
                    `;
                }).join('');
            } else {
                notificationCount.style.display = 'none';
                notificationList.innerHTML = '<div class="dropdown-item text-center text-muted">No upcoming deadlines</div>';
            }
        }

        // Show toast notification
        function showToast(message) {
            // Simple alert for now - you can enhance with Bootstrap Toast
            const toast = document.createElement('div');
            toast.style.cssText = 'position: fixed; top: 100px; right: 20px; background: #28a745; color: white; padding: 15px 25px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 9999;';
            toast.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Initialize
        loadAssignments();
        loadNotifications();

        // Set minimum date to today
        document.getElementById('dueDate').min = new Date().toISOString().split('T')[0];
    </script>
</body>
</html>